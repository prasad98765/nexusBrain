# services:
#   db:
#     image: postgres:16
#     restart: always
#     environment:
#       POSTGRES_USER: prasad
#       POSTGRES_PASSWORD: YourStrongPass123!
#       POSTGRES_DB: nexusdb
#     ports:
#       - "5433:5432"
#     volumes:
#       - postgres_data:/var/lib/postgresql/data

#   web:
#     build: .
#     command: python run.py
#     volumes:
#       - .:/app
#     ports:
#       - "5433:5432"
#     environment:
#       - DATABASE_URL=postgresql+psycopg://sonar:sonar123@43.204.3.223:5432/postgres
#     depends_on:
#       - db

#   pgadmin:
#     image: dpage/pgadmin4
#     restart: always
#     environment:
#       PGADMIN_DEFAULT_EMAIL: admin@admin.com
#       PGADMIN_DEFAULT_PASSWORD: admin
#     ports:
#       - "5050:80"
#     depends_on:
#       - db
#     volumes:
#       - pgadmin_data:/var/lib/pgadmin

# volumes:
#   postgres_data:
#   pgadmin_data:   # ‚úÖ Add this line


# # to run docker compose up --build

# services:
#   web:
#     build: .
#     command: python run.py
#     volumes:
#       - .:/app
#     ports:
#       - "5001:5000"

#   pgadmin:
#     image: dpage/pgadmin4
#     restart: always
#     environment:
#       PGADMIN_DEFAULT_EMAIL: admin@admin.com
#       PGADMIN_DEFAULT_PASSWORD: admin
#     ports:
#       - "5050:80"
#     volumes:
#       - pgadmin_data:/var/lib/pgadmin

# volumes:
#   pgadmin_data:



version: "3.9"

services:
  # ------------------------------
  # üêç Flask Backend
  # ------------------------------
  web:
    build:
      context: ./backend
      dockerfile: Dockerfile
    container_name: backend
    command: python run.py
    volumes:
      - ./backend:/app
    ports:
      - "5001:5000"
    environment:
      - FLASK_ENV=development
      - PYTHONUNBUFFERED=1
    depends_on:
      - pgadmin
    # Uncomment below if backend needs PostgreSQL
    # - db

  # ------------------------------
  # üåê Frontend (Node + NPM)
  # ------------------------------
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    container_name: frontend
    command: npm run dev
    ports:
      - "5173:5173"
    volumes:
      - ./frontend:/app
      - /app/node_modules
    environment:
      - NODE_ENV=development
    depends_on:
      - web

  # # ------------------------------
  # # üêò pgAdmin (Database GUI)
  # # ------------------------------
  # pgadmin:
  #   image: dpage/pgadmin4
  #   container_name: pgadmin
  #   restart: always
  #   environment:
  #     PGADMIN_DEFAULT_EMAIL: admin@admin.com
  #     PGADMIN_DEFAULT_PASSWORD: admin
  #   ports:
  #     - "5050:80"
  #   volumes:
  #     - pgadmin_data:/var/lib/pgadmin

# ------------------------------
# Volumes
# ------------------------------
# volumes:
#   pgadmin_data:
